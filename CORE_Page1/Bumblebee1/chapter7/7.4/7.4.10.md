---
typora-root-url: ..\..\pictures
---

### **7.4.10. mstatus的FS域**

mstatus寄存器中的FS域用于维护或反映浮点单元的状态。

注意：此域只有在配置了浮点指令（“F”或者“D”指令子集）时才会存在。

FS域由两位组成，其编码如下图所示。



![](/../chapter7/7.4/7.4.10.assets/28.png)

​                                                               **<center>图 7-2 FS域表示的状态编码</center>**



FS域的更新准则如下：

- FS上电后的默认值为0，意味着浮点单元的状态为Off。因此为了能够正常使用浮点单元，软件需要使用CSR写指令将FS的值改写为非0值以打开浮点单元（FPU）的功能。
- 如果FS的值为1或者2，当执行了任何的浮点指令之后，FS的值会自动切换为3，表示浮点单元的状态为Dirty（状态发生了改变）。
- 如果处理器不想使用浮点运算单元（譬如将浮点单元关电以节省功耗），可以使用CSR写指令将mstatus寄存器的FS域设置成0，将浮点单元的功能予以关闭。当浮点单元的功能关闭之后，任何访问浮点CSR寄存器的操作或者任何执行浮点指令的行为都将会产生非法指令（Illegal Instruction）异常。

除了用于上述功能，FS域的值还用于操作系统在进行上下文切换时的指引信息，感兴趣的用户请参见RISC-V“特权架构文档版本1.10”原文。

